"use strict";const e=require("vue"),q=require("../../../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/lodash.js"),E=require("../../../../node_modules/.pnpm/@element-plus_icons-vue@2.3.1_vue@3.5.6_typescript@5.6.2_/node_modules/@element-plus/icons-vue/dist/index.js"),t=require("element-plus"),J={key:0,class:"flex"},W=["innerHTML"],X=["innerHTML"],Y={key:1},_={class:"basic-flex-center"},ee=e.defineComponent({name:"ZbSearchForm"}),le=e.defineComponent({...ee,props:{searchList:{default:()=>[]},searchParam:{default:()=>({})},formStyleObject:{},buttonStyleObject:{},searchFormRule:{default:[]},canReset:{type:Boolean,default:!0},showAll:{type:Boolean,default:!1},searchBtnTxt:{default:"搜索"}},emits:["search","reset","changeVal"],setup(A,{expose:I,emit:K}){const m=K,n=e.ref(!1),h=e.ref(!1),c=e.ref();let S=null;const V=e.ref(!0),B=e.ref(!1),i=A,f=e.ref(i.searchList);e.watch(()=>i.searchList,()=>{f.value=i.searchList},{deep:!0});const x=async()=>{await N(),V.value&&m("search",i.searchParam)},Q=()=>{var a;(a=c.value)==null||a.clearValidate(),B.value=!B.value,m("reset")},Z=(a="",o)=>{p(),m("changeVal",a,o)},P=new ResizeObserver(()=>{p()});e.onMounted(()=>{var a;f.value.forEach(o=>{o.filterable&&(o.defaultOptions=q.lodashExports.cloneDeep(o.options),b("",o))}),p(),window.addEventListener("resize",p,{passive:!0});try{P.observe((a=c.value)==null?void 0:a.$el)}catch{}}),e.onUpdated(()=>{p()}),e.onUnmounted(()=>{var a;window.removeEventListener("resize",p);try{P.unobserve((a=c.value)==null?void 0:a.$el)}catch{}});const G=(a,o)=>{f.value[a].defaultOptions=q.lodashExports.cloneDeep(o),b("",f.value[a])},b=(a,o)=>{var l;if(a){let C=a.toLowerCase(),u=(o==null?void 0:o.filterKey)??["label"];o.options=[];for(let s=0;s<o.defaultOptions.length;s++)u.some(w=>{var d;if(o.defaultOptions[s][w]&&((d=o.defaultOptions[s][w])==null?void 0:d.toString()).toLowerCase().includes(C))return!0})&&o.options.push(o.defaultOptions[s])}else o.options=(l=o==null?void 0:o.defaultOptions)==null?void 0:l.slice(0)},p=(a=null)=>{S&&clearTimeout(S),S=setTimeout(()=>{let o=c.value;o&&(o.$el.offsetHeight>118&&(h.value||(n.value=!1),h.value=!0),o.$el.offsetHeight<=118&&(h.value&&(n.value=!1),h.value=!1))},300)};async function N(){var a;return await((a=c.value)==null?void 0:a.validate(async o=>o?(V.value=!0,!0):(V.value=!1,!1)))}return I({resetOptions:G,submit:N,clearValidate:a=>{var o;(o=c.value)==null||o.clearValidate(a)}}),(a,o)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",{class:e.normalizeClass(["search-box",n.value?"":"two-row",a.showAll?"showAll":""])},[(e.openBlock(),e.createBlock(e.unref(t.ElForm),{inline:"",model:a.searchParam,class:"search-form",ref_key:"SearchForm",ref:c,style:e.normalizeStyle(i.formStyleObject),rules:a.searchFormRule,key:B.value},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.value,(l,C)=>(e.openBlock(),e.createBlock(e.unref(t.ElFormItem),{key:C,prop:l.prop},{label:e.withCtx(()=>{var u;return[(l.isShowFunc?l.isShowFunc(a.searchParam):!l.isShow||(u=l.isShow[1])!=null&&u.includes(a.searchParam[l.isShow[0]]))?(e.openBlock(),e.createElementBlock("div",J,[e.createTextVNode(e.toDisplayString(l.label)+" ",1),l.tooltip?(e.openBlock(),e.createBlock(e.unref(t.ElTooltip),{key:0,placement:"top","hide-after":300},{content:e.withCtx(()=>[e.createElementVNode("div",{innerHTML:l.tooltip},null,8,W)]),default:e.withCtx(()=>[e.createVNode(e.unref(t.ElIcon),{style:{"font-size":"12px","margin-left":"5px"}},{default:e.withCtx(()=>[e.createVNode(e.unref(E.QuestionFilled))]),_:1})]),_:2},1024)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)]}),default:e.withCtx(()=>{var u,s,g,w,d,F,L,T,y,O,z,M,U,v,$,k,H,D,j,R;return[l.type==="el-select"&&(l.isShowFunc?l.isShowFunc(a.searchParam):!l.isShow||(u=l.isShow[1])!=null&&u.includes(a.searchParam[l.isShow[0]]))?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[l.type==="el-select"&&(!l.isShow||(s=l.isShow[1])!=null&&s.includes(a.searchParam[l.isShow[0]]))?(e.openBlock(),e.createBlock(e.unref(t.ElTooltip),{key:0,placement:"top","hide-after":300,content:((F=(d=(w=(g=l.options)==null?void 0:g.find(r=>(r==null?void 0:r.value)==a.searchParam[l.prop]))==null?void 0:w.label)==null?void 0:d.toString)==null?void 0:F.call(d))??"",disabled:!!l.multiple||!((((z=(O=(y=(T=(L=l.options)==null?void 0:L.find(r=>(r==null?void 0:r.value)==a.searchParam[l.prop]))==null?void 0:T.label)==null?void 0:y.toString)==null?void 0:O.call(y))==null?void 0:z.length)??0)>9)},{default:e.withCtx(()=>[e.createVNode(e.unref(t.ElSelect),{modelValue:a.searchParam[l.prop],"onUpdate:modelValue":r=>a.searchParam[l.prop]=r,clearable:l.clearable??!0,"popper-class":l.extraHeight?"extraHeight":"",placeholder:l.placeholder,style:e.normalizeStyle(l.width?`width:${l.width}`:""),multiple:l.multiple,remote:l.filterable,filterable:l.filterable,"remote-method":r=>b(r,l),"value-key":"id","collapse-tags":l.multiple,"collapse-tags-tooltip":l.multiple,onChange:r=>Z(r,l)},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.options,r=>(e.openBlock(),e.createBlock(e.unref(t.ElOption),{key:r.value,value:r.value,label:r.label,style:e.normalizeStyle(r.styleObject)},{default:e.withCtx(()=>[r.showLabel?(e.openBlock(),e.createElementBlock("div",{key:0,innerHTML:r.showLabel},null,8,X)):e.createCommentVNode("",!0),r.isEmphasize?(e.openBlock(),e.createElementBlock("div",Y,[e.createElementVNode("div",_,[e.createElementVNode("div",null,e.toDisplayString(r.label),1),o[1]||(o[1]=e.createElementVNode("div",{class:"basic-emphasize-tag"},"重要",-1))])])):e.createCommentVNode("",!0)]),_:2},1032,["value","label","style"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","clearable","popper-class","placeholder","style","multiple","remote","filterable","remote-method","collapse-tags","collapse-tags-tooltip","onChange"])]),_:2},1032,["content","disabled"])):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0),l.type==="el-input"&&(l.isShowFunc?l.isShowFunc(a.searchParam):!l.isShow||(M=l.isShow[1])!=null&&M.includes(a.searchParam[l.isShow[0]]))?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[l.type==="el-input"&&(!l.isShow||(U=l.isShow[1])!=null&&U.includes(a.searchParam[l.isShow[0]]))?(e.openBlock(),e.createBlock(e.unref(t.ElTooltip),{key:0,placement:"top","hide-after":300,content:(($=(v=a.searchParam[l.prop])==null?void 0:v.toString)==null?void 0:$.call(v))??"",disabled:!((((D=(H=(k=a.searchParam[l.prop])==null?void 0:k.toString)==null?void 0:H.call(k))==null?void 0:D.length)??0)>9)},{default:e.withCtx(()=>[l.notTrim?(e.openBlock(),e.createBlock(e.unref(t.ElInput),{key:0,modelValue:a.searchParam[l.prop],"onUpdate:modelValue":r=>a.searchParam[l.prop]=r,clearable:"",placeholder:l.placeholder,style:e.normalizeStyle(l.width?`width:${l.width}`:"")},null,8,["modelValue","onUpdate:modelValue","placeholder","style"])):(e.openBlock(),e.createBlock(e.unref(t.ElInput),{key:1,modelValue:a.searchParam[l.prop],"onUpdate:modelValue":r=>a.searchParam[l.prop]=r,modelModifiers:{trim:!0},clearable:"",placeholder:l.placeholder,style:e.normalizeStyle(l.width?`width:${l.width}`:"")},null,8,["modelValue","onUpdate:modelValue","placeholder","style"]))]),_:2},1032,["content","disabled"])):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0),l.type==="el-date-picker"&&(l.isShowFunc?l.isShowFunc(a.searchParam):!l.isShow||(j=l.isShow[1])!=null&&j.includes(a.searchParam[l.isShow[0]]))?(e.openBlock(),e.createBlock(e.unref(t.ElDatePicker),{key:2,modelValue:a.searchParam[l.prop],"onUpdate:modelValue":r=>a.searchParam[l.prop]=r,modelModifiers:{trim:!0},type:l.dataType??"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",style:{height:"32px"},shortcuts:l.shortcuts,format:l.format??"yyyy-MM-dd","value-format":l.valueFormat??"yyyy-MM-dd"},null,8,["modelValue","onUpdate:modelValue","type","shortcuts","format","value-format"])):e.createCommentVNode("",!0),l.type==="el-cascader"&&(!l.isShow||(R=l.isShow[1])!=null&&R.includes(a.searchParam[l.isShow[0]]))?(e.openBlock(),e.createBlock(e.unref(t.ElCascader),{key:3,placeholder:l.placeholder,options:l.options,props:{...l.cascaderProps},filterable:l.filterable,style:e.normalizeStyle({width:l.width?l.width:"200px"}),clearable:"","show-all-levels":l.showAllLevels,"collapse-tags":"","popper-class":l.class,"filter-method":l.filterMethod,modelValue:a.searchParam[l.prop],"onUpdate:modelValue":r=>a.searchParam[l.prop]=r},null,8,["placeholder","options","props","filterable","style","show-all-levels","popper-class","filter-method","modelValue","onUpdate:modelValue"])):e.createCommentVNode("",!0)]}),_:2},1032,["prop"]))),128))]),_:1},8,["model","style","rules"]))],2),e.createElementVNode("div",{class:"search-button",style:e.normalizeStyle(a.buttonStyleObject)},[e.createVNode(e.unref(t.ElButton),{type:"primary",onClick:x},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.searchBtnTxt),1)]),_:1}),a.canReset?(e.openBlock(),e.createBlock(e.unref(t.ElButton),{key:0,onClick:Q},{default:e.withCtx(()=>o[2]||(o[2]=[e.createTextVNode("重置")])),_:1})):e.createCommentVNode("",!0),e.renderSlot(a.$slots,"funcButton",{},void 0,!0),h.value?(e.openBlock(),e.createBlock(e.unref(t.ElButton),{key:1,onClick:o[0]||(o[0]=l=>n.value=!n.value),icon:n.value?e.unref(E.CaretTop):e.unref(E.CaretBottom)},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.value?"收起":"展开"),1)]),_:1},8,["icon"])):e.createCommentVNode("",!0)],4)],64))}});module.exports=le;
